'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.beaconTransport = beaconTransport;
exports.pixelTransport = pixelTransport;
exports.fetchTransport = fetchTransport;

var _browser = require('./browser');

function beaconTransport(url) {
    return new Promise(function(resolve, reject) {
        return (0, _browser.sendBeacon)(url) ? resolve() : reject(new Error('Transport Error: Cannot send bi using beacons'));
    });
}

function pixelTransport(url, image) {
    return new Promise(function(resolve, reject) {
        var biImage = image || new window.Image(0, 0);
        biImage.onload = function() {
            return resolve();
        };
        biImage.onerror = function() {
            return reject(new Error('Transport Error: Cannot send bi using pixelTransport'));
        };
        biImage.src = url;
    });
}

function fetchTransport(url) {
    return fetch(url, {
        credentials: 'include'
    }).then(function(response) {
        if (!response.ok) {
            throw Error('Transport Error: Cannot send bi using fetch. Status: ' + response.status);
        }
    });
}